var j=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function x(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function A(r){var e=r.default;if(typeof e=="function"){var o=function(){return e.apply(this,arguments)};o.prototype=e.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var t=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(o,n,t.get?t:{enumerable:!0,get:function(){return r[n]}})}),o}var a={exports:{}},H=d;function d(r,e,o,n){if(typeof o!="function")throw new Error("method for before hook must be a function");return n||(n={}),Array.isArray(e)?e.reverse().reduce(function(t,i){return d.bind(null,r,i,t,n)},o)():Promise.resolve().then(function(){return r.registry[e]?r.registry[e].reduce(function(t,i){return i.hook.bind(null,t,n)},o)():o(n)})}var h=w;function w(r,e,o,n){var t=n;r.registry[o]||(r.registry[o]=[]),e==="before"&&(n=function(i,u){return Promise.resolve().then(t.bind(null,u)).then(i.bind(null,u))}),e==="after"&&(n=function(i,u){var f;return Promise.resolve().then(i.bind(null,u)).then(function(y){return f=y,t(f,u)}).then(function(){return f})}),e==="error"&&(n=function(i,u){return Promise.resolve().then(i.bind(null,u)).catch(function(f){return t(f,u)})}),r.registry[o].push({hook:n,orig:t})}var k=m;function m(r,e,o){if(!!r.registry[e]){var n=r.registry[e].map(function(t){return t.orig}).indexOf(o);n!==-1&&r.registry[e].splice(n,1)}}var p=H,C=h,O=k,c=Function.bind,s=c.bind(c);function v(r,e,o){var n=s(O,null).apply(null,o?[e,o]:[e]);r.api={remove:n},r.remove=n,["before","error","after","wrap"].forEach(function(t){var i=o?[e,t,o]:[e,t];r[t]=r.api[t]=s(C,null).apply(null,i)})}function P(){var r="h",e={registry:{}},o=p.bind(null,e,r);return v(o,e,r),o}function b(){var r={registry:{}},e=p.bind(null,r);return v(e,r),e}var g=!1;function l(){return g||(console.warn('[before-after-hook]: "Hook()" repurposing warning, use "Hook.Collection()". Read more: https://git.io/upgrade-before-after-hook-to-1.4'),g=!0),b()}l.Singular=P.bind();l.Collection=b.bind();a.exports=l;a.exports.Hook=l;a.exports.Singular=l.Singular;var S=a.exports.Collection=l.Collection;export{S as C,A as a,j as c,x as g};
