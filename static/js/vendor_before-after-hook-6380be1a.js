var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function n(r){var e=r.default;if("function"==typeof e){var n=function(){return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(r).forEach((function(e){var t=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(n,e,t.get?t:{enumerable:!0,get:function(){return r[e]}})})),n}var t={exports:{}},o=function r(e,n,t,o){if("function"!=typeof t)throw new Error("method for before hook must be a function");o||(o={});if(Array.isArray(n))return n.reverse().reduce((function(n,t){return r.bind(null,e,t,n,o)}),t)();return Promise.resolve().then((function(){return e.registry[n]?e.registry[n].reduce((function(r,e){return e.hook.bind(null,r,o)}),t)():t(o)}))};var i=o,u=function(r,e,n,t){var o=t;r.registry[n]||(r.registry[n]=[]);"before"===e&&(t=function(r,e){return Promise.resolve().then(o.bind(null,e)).then(r.bind(null,e))});"after"===e&&(t=function(r,e){var n;return Promise.resolve().then(r.bind(null,e)).then((function(r){return o(n=r,e)})).then((function(){return n}))});"error"===e&&(t=function(r,e){return Promise.resolve().then(r.bind(null,e)).catch((function(r){return o(r,e)}))});r.registry[n].push({hook:t,orig:o})},l=function(r,e,n){if(!r.registry[e])return;var t=r.registry[e].map((function(r){return r.orig})).indexOf(n);if(-1===t)return;r.registry[e].splice(t,1)},f=Function.bind,a=f.bind(f);function c(r,e,n){var t=a(l,null).apply(null,n?[e,n]:[e]);r.api={remove:t},r.remove=t,["before","error","after","wrap"].forEach((function(t){var o=n?[e,t,n]:[e,t];r[t]=r.api[t]=a(u,null).apply(null,o)}))}function s(){var r={registry:{}},e=i.bind(null,r);return c(e,r),e}var p=!1;function d(){return p||(p=!0),s()}d.Singular=function(){var r={registry:{}},e=i.bind(null,r,"h");return c(e,r,"h"),e}.bind(),d.Collection=s.bind(),t.exports=d,t.exports.Hook=d,t.exports.Singular=d.Singular;var y=t.exports.Collection=d.Collection;export{y as C,n as a,r as c,e as g};
